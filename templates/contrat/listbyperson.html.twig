{% extends 'base.html.twig' %}

{% block body %}
<h1>Contrats par adh√©rent</h1>
	{% set totalMeunier = 0 %}
	{% set totalCheques = 0 %}
	{% set totalReduc = 0 %}
    <table class="table-bordered table-condensed" >
	   <thead>
        <tr>

            <th align="center">Amapiene ou amapien</th>
            <th align="center">Produit</th>
            <th align="center">Type</th>
            <th align="center">Bio</th>
            <th align="center">Poid</th>
            <th>Nombre</th>
            <th>Prix</th>
        </tr>
    </thead>
	{% for nompersonne, personne in personnes %}
		{% if personne.cheque != 0 %}
	    {% set total = 0.0 %}
	<tbody>
		{% for contrat in personne['contrats'] %}
			{% set cout = ((contrat.produit.prix  *  0.93)| round(2) ) * contrat.nombre %}
			{% set total = total + cout %}
		<tr>
			<td>{{ nompersonne }}</td>
			<td align="center"> {{ contrat.produit.nomProduit }} </td>
			<td align="center"> 
			    {% if contrat.produit.t %}
							T {{contrat.produit.t}}
                {% else %} 
                        &nbsp;
				{% endif %}
			</td>
			<td align="center">	
                {% if contrat.produit.bio %}
						bio 
                {% else %}
						non bio
                {% endif %}	</td>
			<td align="center">	{{ contrat.produit.poid }} kg </td>
			<td align="right"> {{ contrat.nombre }} </td>
			<td align="right"> {{ cout|number_format(2, '.', ',')}} </td>
		</tr>
		{% endfor %}
		<tr>
             <th colspan="5">Signature</th>
             <td align="center">Total</td>
              <td align="right" > {{ total|number_format(2, '.', ',') }}</td>
        </tr>
     </tbody>
		{% set totalMeunier = totalMeunier + total %}
	{% endif %}
	{% endfor %}
	<tbody>
	<tr>
	   <th>Total du</th>
	   <td colspan="4">&nbsp;</td>
        <td> {{ totalMeunier }}</td>
     </tr>
     </tbody>
    </table>

{% endblock %} {# body #}
